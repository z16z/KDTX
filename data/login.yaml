## 1.前置操作，获取uuid
#- name: get_verify-code
#  request:
#    method: GET
#    url: http://kdtx-test.itheima.net/api/captchaImage
#  response:
#    status_code: 200
#    json:
#      msg: "操作成功"
#      code: 200
#  extract:
#    uuid: $.uuid

# 依赖uuid的后续用例
# 1.登录成功
- name: login_success
  pre_request: # 增加前置请求
    # 这里可以直接引用 get_verify-code 用例，或者复制其请求体
    # 复制请求体可以保证用例的独立性
    name: get_verify-code
    request:
      method: GET
      url: http://kdtx-test.itheima.net/api/captchaImage
    response:
      status_code: 200
      json:
        msg: "操作成功"
        code: 200
    extract:
      uuid: $.uuid
  request:
    method: POST
    url: http://kdtx-test.itheima.net/api/login
    json:
      username: "admin"
      password: "HM_2023_test"
      code: 2
      uuid: "{{uuid}}" # 引用前面的uuid
  response:
    status_code: 200
    json:
      msg: "操作成功"
      code: 200
  extract:
    token: $.token


# 2.登录失败（用户名为空）
- name: login_username_null
  pre_request: # 增加前置请求
    # 这里可以直接引用 get_verify-code 用例，或者复制其请求体
    # 复制请求体可以保证用例的独立性
    name: get_verify-code
    request:
      method: GET
      url: http://kdtx-test.itheima.net/api/captchaImage
    response:
      status_code: 200
      json:
        msg: "操作成功"
        code: 200
    extract:
      uuid: $.uuid
  request:
    method: POST
    url: http://kdtx-test.itheima.net/api/login
    json:
      username: ""
      password: "HM_2023_test"
      code: 2
      uuid: "{{uuid}}" # 引用前面的uuid
  response:
    status_code: 200
    json:
      msg: "用户不存在/密码错误"
      code: 500

# 3.登录失败（用户名未注册）
- name: login_username_not
  pre_request: # 增加前置请求
    # 这里可以直接引用 get_verify-code 用例，或者复制其请求体
    # 复制请求体可以保证用例的独立性
    name: get_verify-code
    request:
      method: GET
      url: http://kdtx-test.itheima.net/api/captchaImage
    response:
      status_code: 200
      json:
        msg: "操作成功"
        code: 200
    extract:
      uuid: $.uuid
  request:
    method: POST
    url: http://kdtx-test.itheima.net/api/login
    json:
      username: "abcd"
      password: "HM_2023_test"
      code: 2
      uuid: "{{uuid}}" # 引用前面的uuid
  response:
    status_code: 200
    json:
      msg: "用户不存在/密码错误"
      code: 500

# 4.登录失败（密码错误）
- name: login_password_false
  pre_request: # 增加前置请求
    # 这里可以直接引用 get_verify-code 用例，或者复制其请求体
    # 复制请求体可以保证用例的独立性
    name: get_verify-code
    request:
      method: GET
      url: http://kdtx-test.itheima.net/api/captchaImage
    response:
      status_code: 200
      json:
        msg: "操作成功"
        code: 200
    extract:
      uuid: $.uuid
  request:
    method: POST
    url: http://kdtx-test.itheima.net/api/login
    json:
      username: "admin"
      password: "HM"
      code: 2
      uuid: "{{uuid}}" # 引用前面的uuid
  response:
    status_code: 200
    json:
      msg: "用户不存在/密码错误"
      code: 500